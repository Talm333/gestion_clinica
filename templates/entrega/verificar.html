{% extends "base.html" %} {% block content %}
<h2>Verificar Estado de Equipo</h2>

<form method="get" class="mb-4">
  <div class="input-group">
    <input
      type="text"
      name="cliente"
      class="form-control"
      placeholder="Ingrese nombre del cliente"
      value="{{ cliente }}"
    />
    <button type="submit" class="btn btn-primary rounded-pill">Buscar</button>
    <a href="/entrega/listado/" class="btn btn-secondary ms-2 rounded-pill"
      >Ver Historial de Entregas</a
    >
  </div>
</form>

{% if equipos %}
<div class="table-responsive">
  <table class="table table-striped table-hover table-bordered">
    <thead class="table-dark">
      <tr>
        <th>ID</th>
        <th>Cliente</th>
        <th>Equipo</th>
        <th>Fecha Recepción</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      {% for equipo in equipos %}
      <tr>
        <td>#{{ equipo.id }}</td>
        <td>{{ equipo.cliente }}</td>
        <td>{{ equipo.tipo }}</td>
        <td>{{ equipo.fecha|date:"d/m/Y H:i" }}</td>
        <td>
          {% if equipo.diagnosticos.entrega %}
          <span class="badge bg-success">Entregado</span>
          {% elif equipo.diagnosticos %}
          <span class="badge bg-warning text-dark"
            >Diagnósticado (Listo para retiro)</span
          >
          {% else %}
          <span class="badge bg-secondary">En Taller</span>
          {% endif %}
        </td>
        <td>
          {% if equipo.diagnosticos and not equipo.diagnosticos.entrega %}
          <a
            href="/entrega/reporte/?diagnostico={{ equipo.diagnosticos.id }}"
            class="btn btn-primary btn-sm rounded-pill"
            >Entregar</a
          >
          {% elif equipo.diagnosticos.entrega %}
          <a
            href="{% url 'comprobante_entrega' equipo.diagnosticos.entrega.id %}"
            class="btn btn-info btn-sm rounded-pill"
            >Ver Comprobante</a
          >
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% elif cliente %}
<div class="alert alert-warning">
  No se encontraron equipos para el cliente "{{ cliente }}".
</div>
{% endif %} {% endblock content %}
